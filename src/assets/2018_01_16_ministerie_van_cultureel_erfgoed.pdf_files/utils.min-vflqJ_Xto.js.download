define(["require","exports","tslib","modules/clean/open_with","modules/clean/file_store/utils","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/open_button/types","modules/clean/react/file_viewer/unity/unity_utils","modules/clean/react/file_viewer/open_with_helpers","modules/clean/react/paper/utils","modules/clean/react/file_viewer/data/actions","modules/core/i18n","modules/clean/react/extensions/utils","modules/clean/react/extensions/connect_flow","modules/clean/cloud_docs/open_with_utils"],(function(e,n,t,i,o,r,s,l,a,u,p,d,c,f,_){"use strict";function h(e,n,i,o){var l;if(o.provider===_.OpenWithCloudDocProvider.GoogleDSS)l={type:s.OpenButtonAction.OPEN_WITH_CLOUD_DOC,userAction:r.UserAction.OpenWithCloudDocEditor};else{if(o.provider!==_.OpenWithCloudDocProvider.OfficeOnline)return null;l={type:s.OpenButtonAction.OPEN_WITH,userAction:r.UserAction.OpenInOfficeOnline}}return t.__assign({handler:function(){return o.handler(e,n,i)},spriteName:o.spriteName||null,iconUrl:o.iconUrl,text:o.text},l)}function O(e){for(var n=e.file,t=e.user,i=e.isOpenWithDisabled,o=[],r={gdd:!e.isCloudEditorDisabled,wopi:m({file:n,isOpenWithDisabled:i,user:t})},s=e.actionSource,l=0,a=_.getOpenWithCloudEditorInfo(n,t,r,s);l<a.length;l++){var u=h(n,t,s,a[l]);u&&o.push(u)}return o}function m(e){var n=e.file,t=e.isOpenWithDisabled,i=e.user;return!t&&a.OpenWithHelpers.canOpenWith(n,i)}function v(e){var n=(e?e.open_application_name:void 0)||d.intl.formatMessage({id:"Uyxn/h",defaultMessage:"Desktop"});return d.intl.formatMessage({id:"KtD8FA",defaultMessage:"Open in {app_name}"},{app_name:n})}function y(e){var n=(null!==e?e.file_browser_display_name:void 0)||d.intl.formatMessage({id:"Bbnzjx",defaultMessage:"File Browser"});return d.intl.formatMessage({id:"suwlZc",defaultMessage:"Show in {file_browser}"},{file_browser:n})}function g(e){var n=e.file,t=e.isFolder,i=e.user;return function(){l.UnityHelpers.openFile(n.ns_id,n.ns_path,i.id,t)}}function A(e){var n=e.file,t=e.user;return function(){u.openFileInPaper({file:n,user:t})}}Object.defineProperty(n,"__esModule",{value:!0}),i=t.__importDefault(i),n.getOpenOptions=function(e){var n=e.file,i=t.__rest(e,["file"]);return o.isBrowseFile(n)?(function(e){var n=e.file,t=e.hasOpenInPaperSupport,i=e.isUnityDisabled,o=e.isOpenWithDisabled,a=e.isCloudEditorDisabled,u=e.unityInfo,O=e.extraOptions,w=e.user,I=e.sharingServiceInfo,U=e.refreshSharingServiceInfo,D=e.showOpenWithShare,b=e.onPresentInZoom,S=e.isCloudBasedDoc,E=e.actionSource,N=e.landingPagesEnabled;if(!u)return[];var M=[];t&&M.push({handler:A({file:n,user:w}),spriteName:"paper",text:d.intl.formatMessage({id:"MhNU0E",defaultMessage:"Copy to Paper"}),type:s.OpenButtonAction.OPEN_IN_PAPER,userAction:r.UserAction.CopyToPaper});!S&&(function(e){var n=e.isUnityDisabled,t=e.unityInfo;return null!=t&&!n&&l.UnityHelpers.isUnityFileSupported(t)})({isUnityDisabled:i,unityInfo:u})&&M.push({handler:g({file:n,user:w,isFolder:!1}),spriteName:"ow_desktop",text:v(u),type:s.OpenButtonAction.UNITY_FILE,userAction:r.UserAction.OpenInUnity});for(var F=m({file:n,isOpenWithDisabled:o,user:w}),W={gdd:!a,wopi:F},P=_.getOpenWithCloudEditorInfo(n,w,W,E),C=0,x=P;C<x.length;C++){var B=x[C],T=h(n,w,E,B);T&&M.push(T)}(function(e){var n=e.isUnityDisabled,t=e.unityInfo;return null!=t&&!n&&l.UnityHelpers.isUnityFolderSupported(t)})({isUnityDisabled:i,unityInfo:u})&&M.push({handler:g({file:n,user:w,isFolder:!0}),spriteName:"ow_folder",text:y(u),type:s.OpenButtonAction.UNITY_FOLDER,userAction:r.UserAction.OpenInUnityFolder});O&&O.forEach((function(e){e&&M.push(e)}));M.length||S||M.push({handler:function(){return p.download(n)},spriteName:null,text:d.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),type:s.OpenButtonAction.DOWNLOAD,userAction:r.UserAction.Download});var H=!1,k=!1;D&&I&&(H=c.isSlackAvailable(I),k=c.isZoomAvailable(I));H&&I&&U&&M.push({handler:function(){return f.shareInSlackFlow(w,I,U,n,"open_with_button",void 0!==N?N:null)},spriteName:null,text:d.intl.formatMessage({id:"Qws4v2",defaultMessage:"Slack"}),type:s.OpenButtonAction.SHARE_TO_SLACK,userAction:r.UserAction.ShareToSlack});k&&I&&b&&U&&M.push({handler:function(){return f.presentInZoomFlow(w,I,U,b,"open_with_button",void 0!==N?N:null)},spriteName:null,text:d.intl.formatMessage({id:"mzy+1c",defaultMessage:"Zoom"}),type:s.OpenButtonAction.PRESENT_IN_ZOOM,userAction:r.UserAction.PresentInZoom});return M})(t.__assign({file:n},i)):o.isSharedFile(n)?O(t.__assign({file:n},i)):[]},n.convertOpenWithCloudEditorInfo=h,n.getOpenOptionsSharedFile=O,n.shouldShowCoachmark=function(e,n){var t=e.map((function(e){return e.type})).includes(s.OpenButtonAction.UNITY_FILE),o=n&&i.default.is_adobe_app(n.open_application_identifier),r=e.map((function(e){return e.type})).includes(s.OpenButtonAction.OPEN_WITH);return t&&o||r}}));
//# sourceMappingURL=utils.min.js-vfljLCZTg.map